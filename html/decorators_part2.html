<!-- Auto generated -->
<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Python Articles</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="http://fonts.googleapis.com/css?family=Muli|Domine|Amaranth:400,700&subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <!--link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"-->
 	<link href="//netdna.bootstrapcdn.com/bootswatch/2.3.2/flatly/bootstrap.min.css" rel='stylesheet' >
   <link href="//netdna.bootstrapcdn.com/font-awesome/2.0/css/font-awesome.css" rel="stylesheet">
    <link href="/static/css/app.css?v=2" rel="stylesheet">
</head>
<body>


<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="brand" href="/">&nbsp;The Journey&nbsp;</a>
            <ul class="nav">
                <li class=""><a href="/">Home</a></li>
                <li class="">
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Posts<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        
                        <li>
                            <a href="/decorators_part1.html">
                                decorators_part1
                            </a>
                        </li>
                        
                        <li>
                            <a href="/decorators_part2.html">
                                decorators_part2
                            </a>
                        </li>
                        
                        <li>
                            <a href="/generators.html">
                                generators
                            </a>
                        </li>
                        
                        <li>
                            <a href="/introduction_to_flask.html">
                                introduction_to_flask
                            </a>
                        </li>
                        
                        <li>
                            <a href="/itertools.html">
                                itertools
                            </a>
                        </li>
                        
                    </ul>
                </li>
                </li>
                <li>
                    <form class="navbar-search pull-left" action="/search" method="post">
                        <input type="text" class="search-query" placeholder="Search" id="term" name="term">
                    </form>
                </li>
            </ul>
        </div>
    </div>
</div>
    <div class="container main-content">
        
<article id="content_html" class="span10">
    <p>In the part 1, we described the most basic usage of the decorators. Decorators are functions that intercepts the actual implementation
and do something. Remember that functions are first class citizens(objects) in Python.</p>

<p>Fire up your favorite terminal, navigate to code directory and initialize python; start typing </p>

<div class="codehilite"><pre><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">ver2</span> <span class="kn">import</span> <span class="o">*</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">original_int</span> <span class="o">=</span> <span class="nb">int</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nd">@intercept_me</span>
<span class="o">...</span> <span class="k">def</span> <span class="nf">int</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
<span class="o">...</span>     <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Overwritten integer function is here :)&quot;</span><span class="p">)</span>
<span class="o">...</span>     <span class="n">res</span> <span class="o">=</span> <span class="n">original_int</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">res</span>
<span class="o">...</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">09</span> <span class="mi">20</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">,</span><span class="mi">906</span><span class="p">](</span><span class="n">ver2</span><span class="o">.</span><span class="n">py</span><span class="c">#20)DEBUG   Starting capturing the time of the executing &#39;int&#39;</span>
<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">09</span> <span class="mi">20</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">,</span><span class="mi">906</span><span class="p">](</span><span class="o">&lt;</span><span class="n">stdin</span><span class="o">&gt;</span><span class="c">#3)INFO    Overwritten integer function is here :)</span>
<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">09</span> <span class="mi">20</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">09</span><span class="p">,</span><span class="mi">907</span><span class="p">](</span><span class="n">ver2</span><span class="o">.</span><span class="n">py</span><span class="c">#25)DEBUG   Function: [int] =&gt; Took [0:00:00.000226]</span>
<span class="mi">10000</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="s">&quot;231232&quot;</span><span class="p">)</span>
<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">09</span> <span class="mi">20</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">875</span><span class="p">](</span><span class="n">ver2</span><span class="o">.</span><span class="n">py</span><span class="c">#20)DEBUG   Starting capturing the time of the executing &#39;int&#39;</span>
<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">09</span> <span class="mi">20</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">876</span><span class="p">](</span><span class="o">&lt;</span><span class="n">stdin</span><span class="o">&gt;</span><span class="c">#3)INFO    Overwritten integer function is here :)</span>
<span class="p">[</span><span class="mi">2013</span><span class="o">-</span><span class="mo">07</span><span class="o">-</span><span class="mi">09</span> <span class="mi">20</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">876</span><span class="p">](</span><span class="n">ver2</span><span class="o">.</span><span class="n">py</span><span class="c">#25)DEBUG   Function: [int] =&gt; Took [0:00:00.000315]</span>
<span class="mi">231232</span>
<span class="o">&gt;&gt;&gt;</span> 
</code></pre></div>

<p>Python builtin function <strong>int</strong> overriden at the above code, and we redefined the int function. Now, whenever you call
the int function, our decorator will take presedance and calculate the performance of the integer. Be aware that
this is not a good way to time execution of a program or function, but think of it is as a informant.</p>

<h2>Implement decorator via a class</h2>

<div class="codehilite"><pre><code><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;[</span><span class="si">%(asctime)s</span><span class="s">](</span><span class="si">%(filename)s</span><span class="s">#</span><span class="si">%(lineno)d</span><span class="s">)</span><span class="si">%(levelname)-7s</span><span class="s"> </span><span class="si">%(message)s</span><span class="s">&#39;</span><span class="p">,</span>
                    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">NOTSET</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">intercept_me</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
      <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

   <span class="k">def</span> <span class="nf">__call__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nd">@intercept_me</span>
<span class="k">def</span> <span class="nf">some_slow_function</span><span class="p">():</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Will sleep a bit..&quot;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span> <span class="nb">int</span><span class="p">((</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">%</span><span class="mi">5</span><span class="p">))</span>
    <span class="k">return</span> <span class="s">&#39;boohoo&#39;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;{0} Starting iter {1}{0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="s">&quot;=&quot;</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">some_slow_function</span><span class="p">())</span>

<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;done&quot;</span><span class="p">)</span>
</code></pre></div>

<p>will result in the following output in your console. As you see, the constructor of our class is only called one time,
which means that the class is initialized only one time.</p>

<pre><code>[2013-07-09 21:05:07,815](dec_via_class.py#12)DEBUG   4300575376
[2013-07-09 21:05:07,815](dec_via_class.py#24)INFO    ==================== Starting iter 1====================
[2013-07-09 21:05:07,815](dec_via_class.py#19)INFO    Will sleep a bit..
[2013-07-09 21:05:10,816](dec_via_class.py#25)INFO    boohoo
[2013-07-09 21:05:10,816](dec_via_class.py#24)INFO    ==================== Starting iter 2====================
[2013-07-09 21:05:10,816](dec_via_class.py#19)INFO    Will sleep a bit..
[2013-07-09 21:05:13,817](dec_via_class.py#25)INFO    boohoo
[2013-07-09 21:05:13,817](dec_via_class.py#27)INFO    done
</code></pre>

    <hr />
    <a href="https://twitter.com/share" class="twitter-share-button" data-lang="en" data-related="bahadircambel: Entreprenership 'n Programming " data-text='decorators_part2'>Tweet</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    <a href="http://news.ycombinator.com/submit" class="hn-share-button">Vote on HN</a>
</article>


        <div id="disqus_thread"></div>
        <hr />

        <div class="footer">
            <i class="icon-github"></i>&nbsp;<a href="https://github.com/bcambel">GitHub</a> /
            <i class="icon-twitter"></i>&nbsp;<a href="http://twitter.com/bahadircambel">Twitter</a> /
            <i class="icon-envelope-alt"></i>&nbsp;<a href="mailto:bcambel@gmail.com">E-Mail</a>
        <br />
        &copy; Copyright 2012 by Bahadir Cambel
        </div>
    </div>
    <div class="profile">
        <div class="">
            <img src='/static/img/profile.jpg' alt='Bahadir Cambel' class="img-circle"/>
        </div>
        <p>
            Entrepreneur & Programmer
        </p><div class="keywords">Python, MongoDB, PostgreSQL, Flask, Celery</div>
        <div class="social">
            <a href="https://twitter.com/bahadircambel" class="twitter-follow-button" data-show-screen-name="false" data-show-count="true" data-lang="en">Follow @me</a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
        </div>
        <div>
            <i class="icon-github"></i>&nbsp;<a href="https://github.com/bcambel">GitHub</a> <br />
            <i class="icon-twitter"></i>&nbsp;<a href="http://twitter.com/bahadircambel">Twitter</a> <br />
            <i class="icon-envelope-alt"></i>&nbsp;<a href="mailto:bcambel@gmail.com">E-Mail</a> <br />
        </div>
    </div>


<script type="text/javascript">
    var disqus_shortname = 'entreprogrammeurjourney';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.0.2/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/static/js/jquery.masonry.js"></script>
<script src="/static/js/markdown.js" type='text/javascript'></script>
<script src="/static/js/app.js" type='text/javascript'></script>
<script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37002437-2']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

</script>
<script>
    (function(d, t) {
        var g = d.createElement(t),
                s = d.getElementsByTagName(t)[0];
        g.src = '//hnbutton.appspot.com/static/hn.min.js';
        s.parentNode.insertBefore(g, s);
    }(document, 'script'));
</script>
</body>
</html>